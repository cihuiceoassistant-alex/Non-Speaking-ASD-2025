<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025年有限口語自閉症者國際研討會報名</title>
    <style>
        :root{--pink:#e27d9a;--gray:#e9ecef;--light:#fdfafa;--bg:#ffffff;--focus:#e27d9a22;--text:#444444}
        body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Microsoft JhengHei",sans-serif;background:#f8f9fb;padding:20px;margin:0;line-height:1.7;color:var(--text)}
        .c{max-width:760px;margin:0 auto;background:var(--bg);border-radius:26px;overflow:hidden;box-shadow:0 16px 50px rgba(226,125,154,.15)}
        .h{background:linear-gradient(135deg,#eba1b5,var(--pink));color:white;padding:46px 36px;text-align:center}
        .h h1{font-size:24px;line-height:1.45;font-weight:600;margin:0}
        .i{padding:42px 36px;background:var(--light);line-height:1.9;font-size:16px;color:#555}
        .i strong{color:var(--pink)}
        form{padding:0 36px 46px 36px}
        label{display:block;margin:28px 0 10px;font-weight:600;font-size:15.8px;color:#555}
        input,select,textarea{width:100%;padding:17px 22px;border:2px solid var(--gray);border-radius:18px;font-size:16px;box-sizing:border-box;background:white;transition:all .3s}
        input:focus,select:focus,textarea:focus{border-color:var(--pink);outline:none;box-shadow:0 0 0 6px var(--focus)}
        select{height:58px} textarea{height:124px;resize:vertical}
        .agree-box{margin:34px 0 10px;padding:26px;background:#fff9fb;border:2px solid #f5d9e3;border-radius:20px}
        .agree-box label{margin:0;font-weight:normal;font-size:15.8px;line-height:1.85;display:flex;gap:18px;align-items:flex-start;cursor:pointer}
        .agree-box input[type="checkbox"]{width:27px;height:27px;border-radius:10px;flex-shrink:0;accent-color:var(--pink)}
        .agree-box strong{color:var(--pink)}
        button{width:100%;padding:20px;background:#ced6e0;color:#888;border:none;border-radius:20px;font-size:18px;font-weight:bold;cursor:not-allowed;transition:all .35s;margin-top:14px}
        button.active{background:var(--pink);color:white;cursor:pointer;box-shadow:0 10px 28px rgba(226,125,154,.35)}
        button.loading{background:#d65a7f;pointer-events:none}
        #dietDetails{display:none;margin-top:16px}
        .ok,.error{margin:32px 36px;padding:30px;border:2px solid #f5d9e3;border-radius:20px;text-align:center;font-size:18.5px;font-weight:bold;display:none}
        .ok{background:#fff5f8;color:var(--pink)}
        .error{background:#fff5f5;color:#e74c3c;border-color:#f5d9d9}
        .loading-text::after{content:' .';animation:dot 1.5s infinite}
        @keyframes dot{0%,20%{content:' .'}40%{content:' ..'}60%{content:' ...'}80%,100%{content:' .'}}
    </style>
</head>
<body>
<div class="c">
    <div class="h"><h1>2025年「有限口語自閉症者國際研討會<br>—共融、共創、共進」報名表</h1></div>
    <div class="i">
        <strong>【研討會簡介】</strong><br>
        本研討會聚焦「有限口語自閉症者」的溝通權利與支持，邀請美國與台灣跨域專家，從腦科學、臨床實務、教育政策到社區生活模式，探討如何以 ECTA（擴大性溝通治療）與 AAC（輔助與替代性溝通）為基礎，建立具可溝通性、多元融合的社區支持體系。<br><br>
        日期：2025年12月20日（六）－21日（日）　｜　地點：新北市政府大樓511會議室（99席）<br>
        主辦：財團法人慈暉社會福利基金會 × 中華希隱力健康生活協會
    </div>

    <form id="seminarForm">
        <input type="hidden" id="timestamp">

        <label>姓名 <span style="color:var(--pink)">*</span></label>
        <input type="text" id="name" required>

        <label>電子信箱 <span style="color:var(--pink)">*</span></label>
        <input type="email" id="email" required>

        <label>行動電話號碼 <span style="color:var(--pink)">*</span></label>
        <input type="tel" id="phone" required>

        <label>服務單位／就讀學校</label>
        <input type="text" id="unit">

        <label>職稱／身份</label>
        <input type="text" id="title">

        <label>您預計參加場次 <span style="color:var(--pink)">*</span></label>
        <select id="session" required>
            <option value="">請選擇</option>
            <option value="12月20日（六）">12月20日（六）</option>
            <option value="12月21日（日）">12月21日（日）</option>
            <option value="兩天皆參加">兩天皆參加</option>
        </select>

        <label>是否用餐 <span style="color:var(--pink)">*</span></label>
        <select id="meal" required>
            <option value="">請選擇</option>
            <option value="素食">用餐（素食）</option>
            <option value="不用餐">不用餐</option>
        </select>

        <label>您是否需要特殊協助或無障礙服務？ <span style="color:var(--pink)">*</span></label>
        <textarea id="assist" required placeholder="如輪椅席位、手語翻譯、AAC設備等。若無需求請填「無」"></textarea>

        <label>午餐調查 <span style="color:var(--pink)">*</span></label>
        <select id="diet" required onchange="
            document.getElementById('dietDetails').style.display = 
            this.value === '有過敏或特殊飲食需求' ? 'block' : 'none';
        ">
            <option value="">請選擇</option>
            <option value="無特殊需求">無特殊需求</option>
            <option value="有過敏或特殊飲食需求">有過敏或特殊飲食需求</option>
        </select>

        <div id="dietDetails">
            <input type="text" id="dietDetail" placeholder="請說明過敏原或飲食限制">
        </div>

        <div class="agree-box">
            <label for="agree">
                <input type="checkbox" id="agree" required>
                <span><strong>報名確認 <span style="color:var(--pink)">*</span></strong><br>
                我確認以上資訊正確，並同意報名本活動。</span>
            </label>
        </div>

        <button type="submit" id="btn">送出報名</button>

        <div id="ok" class="ok">報名成功！感謝您的參與，我們會盡快寄送確認信給您</div>
        <div id="error" class="error">送出失敗，請稍後再試或聯繫主辦單位</div>
    </form>
</div>

<script>
    // ⭐⭐⭐ 請換成你最新部署的 Apps Script Web App URL
    const SCRIPT_URL = "https://script.google.com/macros/s/你的-webapp-url/exec";

    const form = document.getElementById('seminarForm');
    const btn = document.getElementById('btn');
    const ok = document.getElementById('ok');
    const errorDiv = document.getElementById('error');
    const agree = document.getElementById('agree');

    agree.onchange = () => {
        if (agree.checked) { btn.classList.add('active'); btn.textContent = '立即送出報名'; }
        else { btn.classList.remove('active'); btn.textContent = '送出報名'; }
    };

    form.addEventListener('submit', async e => {
        e.preventDefault();
        if (!btn.classList.contains('active')) return;

        ok.style.display = errorDiv.style.display = 'none';
        btn.classList.add('loading');
        btn.textContent = '傳送中…';

        // 時間戳記
        const timestamp = new Date().toLocaleString('zh-TW', { timeZone: 'Asia/Taipei' });

        // 依照試算表欄位建立完整資料對應
        const data = {
            timestamp,
            name: document.getElementById('name').value.trim(),
            email: document.getElementById('email').value.trim(),
            phone: document.getElementById('phone').value.trim(),
            unit: document.getElementById('unit').value.trim(),
            session: document.getElementById('session').value,
            mealVegetarian: document.getElementById('meal').value === '素食' ? '是' : '',
            mealNo: document.getElementById('meal').value === '不用餐' ? '是' : '',
            title: document.getElementById('title').value.trim(),
            assist: document.getElementById('assist').value.trim(),
            diet: document.getElementById('diet').value,
            dietDetail:
                document.getElementById('diet').value === '有過敏或特殊飲食需求'
                    ? (document.getElementById('dietDetail').value.trim() || '未填寫')
                    : '無',
            confirm: document.getElementById('agree').checked ? "同意" : "未同意"
        };

        try {
            const res = await fetch(SCRIPT_URL, {
                method: 'POST',
                mode: 'cors',
                headers: { 'Content-Type': 'application/json;charset=utf-8' },
                body: JSON.stringify(data)
            });

            const result = await res.json();

            if (res.ok && result.status === 'success') {
                ok.style.display = 'block';
                form.reset();
                document.getElementById('dietDetails').style.display = 'none';
                btn.classList.remove('active','loading');
                btn.textContent = '送出報名';
                setTimeout(() => ok.style.display = 'none', 9000);
            } else {
                throw new Error(result.message || '未知錯誤');
            }
        } catch (err) {
            console.error(err);
            errorDiv.textContent = '送出失敗：' + (err.message || '請檢查網路或重新部署 Web App');
            errorDiv.style.display = 'block';
            btn.classList.remove('loading');
            btn.textContent = '立即送出報名';
        }
    });
</script>

</body>
</html>
